From 706a1c624c591e404a7739b49fd33830427ff2af Mon Sep 17 00:00:00 2001
From: zherczeg <zherczeg@6239d852-aaf2-0410-a92c-79f79f948069>
Date: Mon, 25 Mar 2019 14:10:24 +0000
Subject: [PATCH] Disable SSE2 JIT optimizations in x86 CPUs when SSE2 is not
 available.
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

git-svn-id: svn://vcs.exim.org/pcre2/code/trunk@1082 6239d852-aaf2-0410-a92c-79f79f948069
Signed-off-by: Petr Písař <ppisar@redhat.com>
---
 src/pcre2_jit_compile.c | 2 +-

diff --git a/src/pcre2_jit_compile.c b/src/pcre2_jit_compile.c
index 6519b4b..256356c 100644
--- a/src/pcre2_jit_compile.c
+++ b/src/pcre2_jit_compile.c
@@ -6268,7 +6268,7 @@ for (i = 0; i < max; i++)
   }
 
 #if (defined SLJIT_CONFIG_X86 && SLJIT_CONFIG_X86) && !(defined SUPPORT_VALGRIND) && !(defined _WIN64)
-if (check_fast_forward_char_pair_sse2(common, chars, max))
+if (sljit_has_cpu_feature(SLJIT_HAS_SSE2) && check_fast_forward_char_pair_sse2(common, chars, max))
   return TRUE;
 #endif
 
-- 
2.20.1

